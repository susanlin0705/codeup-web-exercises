<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Call</title>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        #map {
            /* the width and height may be set to any size */
            width: 80%;
            margin: auto;
            height: 700px;
        }
    </style>
</head>
<body>


<h1>Weather Applicatiomn</h1>

<div>
    <h2>San Antonio</h2>
</div>








<div id="date"></div>
<form method="">
    <label for="latitude">Latitude</label>
    <input type="text" name="latitude" id="latitude">
    <label for="longitude">Longitude</label>
    <input type="text" name="longitude" id="longitude">
    <button id="submit" onclick="retrieve()">Search</button>
</form>


<div id="map"></div>
<!--mapbox使用-->
<script src="js/mapbox-geocoder-utils.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.0/mapbox-gl.js'></script>
<script src="js/keys.js"></script>
<script>
    mapboxgl.accessToken = mapboxToken;

    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 10,
        center: [-98.4916, 29.4252]
    });
</script>


<script src="js/keys.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<!--ＡＰＩ使用-->
<script>










    function retrieve() {

        var latitude = document.getElementById("latitude").value;
        var longitude= document.getElementById("longitude").value;
        var userPosition= latitude + "," + longitude


        console.log(userPosition);
    }

    $("#submit").click(retrieve);


    var icons = [{name:"clear-day", url:"Sun.svg"}, {name:"clear-night",url:"Moon.svg"}, {name:"rain",url:"Cloud-Rain.svg"}, {name:"snow",url:"Cloud-Snow.svg"}, {name:"sleet",url:"Cloud-Hail.svg"}, {name:"wind",url:"Cloud-Wind.svg"},
        {name:"fog",url:"Cloud-Fog.svg"}, {name:"cloudy",url:"Cloud.svg"}, {name:"partly-cloudy-day",url:"Cloud-Sun.svg"}, {name:"partly-cloudy-night",url:"Cloud-Fog-Moon.svg"}];


    $.get("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/"+ darkSkyeKey+"/29.4241,-98.4936").done(function (data) {
        console.log(data)






        var reports= data.daily.data.slice(0,3)
        console.log(reports);
        var weather= ''
        reports.forEach(function(report){
            // var chooseIcon=''
            icons.forEach(function(icon){
                if(report.icon===icon.name){
                    report.url=icon.url
                }

            });


            var dateObject = new Date(report.time * 1000);

            console.log(dateObject);

            weather+="<div>"
            weather+="<div>"+ dateObject + "<div>";
            weather+="<div>"+report.temperatureHigh +"  ||  "+ report.temperatureLow +"</div>";
            weather+="<div><img src='icon/" + report.url +"'/></div>";
            weather+="<div> Clouds: " + report.summary + "</div>";
            weather+= "<div>Humidity: " + report.humidity.toFixed(1)+ "</div>";
            weather+= "<div>Wind: " + report.windSpeed.toFixed(1) + "</div>";
            weather+= "<div>Pressure: " + report.pressure.toFixed(1) + "</div>";
            weather+= "</div>"




        });
        $("#date").html(weather);



















    })



































    // var icons = [{name:"clear-day", url:"Sun.svg"}, {name:"clear-night",url:"Moon.svg"}, {name:"rain",url:"Cloud-Rain.svg"}, {name:"snow",url:"Cloud-Snow.svg"}, {name:"sleet",url:"Cloud-Hail.svg"}, {name:"wind",url:"Cloud-Wind.svg"},
    //     {name:"fog",url:"Cloud-Fog.svg"}, {name:"cloudy",url:"Cloud.svg"}, {name:"partly-cloudy-day",url:"Cloud-Sun.svg"}, {name:"partly-cloudy-night",url:"Cloud-Fog-Moon.svg"}];


   // $.get("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/"+darkSkyeKey+"/29.4241,-98.4936").done(function (data) {
   //      console.log(data);
   //      var daily= data.daily.data.slice(0,3);
   //     console.log(daily)
   //
   //     var weather ="";
   //
   //     daily.forEach(function(info) {
   //         console.log("humidity", info.humidity);
   //
   //         var chosenIcon = ""
   //         icons.forEach(function(icon){
   //             if(icon.name === info.icon) {
   //                 chosenIcon = icon.url
   //             }
   //         })
   //
   //         weather += "<div>";
   //         weather += "<div><p>" + info.temperatureHigh + "|" + info.temperatureLow+"</p></div>";
   //         weather += "<div><img src='icon/"+ chosenIcon +"'/></div>";
   //         weather += "<div>" + info.summary + "</div>";
   //         weather += "<div>Humidity: " + info.humidity+ "</div>";
    //         weather += "<div>Wind: " + info.windSpeed + "</div>";
    //         weather += "<div>Pressure: " + info.pressure + "</div>";
    //         weather += "</div>"
    //     });
   //     $("#date").html(weather)
   //
   //
   //
   //
   //  })
</script>
</body>
</html>